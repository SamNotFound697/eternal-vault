<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Visuals</title>
    <link rel="stylesheet" href="../assets/styles.css">
</head>
<body>

<header class="realm-header">
    <h1 class="realm-title">Visuals</h1>
    <p class="realm-subtitle">Images, wallpapers, edits, and visual creations.</p>
</header>

<main>
    <section class="control-panel">
        <button id="create-folder-btn" class="btn">+ New Folder</button>
    </section>

    <div id="realm-feed" class="feed-grid"></div>
</main>

<script>
    window.REALM = "visuals";
</script>

<script type="module">
    import { 
        listFiles, 
        listFolders, 
        createFolder, 
        fileURL 
    } from "../assets/main.js";

    const feed = document.getElementById("realm-feed");
    const btn = document.getElementById("create-folder-btn");

    async function loadRealm() {
        feed.innerHTML = "";

        const folders = await listFolders(window.REALM);
        const files = await listFiles(window.REALM);

        folders.forEach(folder => {
            const el = document.createElement("a");
            el.className = "folder-card";
            el.href = `./${folder.name}/`;
            el.textContent = folder.name;
            feed.appendChild(el);
        });

        files.forEach(f => {
            const url = fileURL(`${window.REALM}/${f.name}`);

            const el = document.createElement("a");
            el.className = "file-card";
            el.href = url;
            el.target = "_blank";
            el.rel = "noopener";
            el.textContent = f.name;
            feed.appendChild(el);
        });
    }

    btn.addEventListener("click", async () => {
        const name = prompt("Folder name:");
        if (!name) return;

        const ok = await createFolder(window.REALM, name);
        if (ok) loadRealm();
        else alert("Failed");
    });

    loadRealm();
</script>

</body>
</html>
